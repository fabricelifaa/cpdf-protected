<?php require "vendor/autoload.php";use setasign\Fpdi\Fpdi;use setasign\Fpdi\PdfReader;use setasign\FpdiProtection\FpdiProtection;class Proctectpdf{protected $pdf=null;public function __construct($file,$user_pass,$master_pass=null){$this->protect($file,$user_pass,$master_pass);}public function protect($file,$user_pass,$master_pass=null){$pdf=new FpdiProtection();$pagecount=$pdf->setSourceFile($file);for($i=1;$i<=$pagecount;$i++){$tplidx=$pdf->importPage($i);$specs=$pdf->getTemplateSize($tplidx);$pdf->addPage($specs['orientation'],[$specs['width'],$specs['height']]);$pdf->useTemplate($tplidx);}$pdf->SetProtection([FpdiProtection::PERM_PRINT,FpdiProtection::PERM_DIGITAL_PRINT],$user_pass,$master_pass);$pdf->SetCreator("Kamgoko");$this->pdf=$pdf;return $this;}public function setTitle($title){$this->pdf->SetTitle($title);return $this;}public function output($name,$type='I'){if($type==='S'){return $this->pdf->Output($type,$name);}else{$this->pdf->Output($type,$name);}return $this;}}